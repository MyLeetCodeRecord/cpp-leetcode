#### å•è°ƒæ ˆ

|ç±»å‹ä¸€: ä¸¤ä¾§æœ€è¿‘æ›´å¤§/æ›´å°å€¼|ç±»å‹äºŒ: top'-top-cur|
|        :-:       |        :-:       |
|[Acwing830. å•è°ƒæ ˆ](https://github.com/MyLeetCodeRecord/cpp-leetcode/blob/master/markdown/%E4%B8%93%E9%A2%98%20-%20%E5%8D%95%E8%B0%83%E6%A0%88.md#acwing830-%E5%8D%95%E8%B0%83%E6%A0%88)|[LC907. å­æ•°ç»„çš„æœ€å°å€¼ä¹‹å’Œ](https://github.com/MyLeetCodeRecord/cpp-leetcode/blob/master/markdown/%E4%B8%93%E9%A2%98%20-%20%E5%8D%95%E8%B0%83%E6%A0%88.md#lc907-%E5%AD%90%E6%95%B0%E7%BB%84%E7%9A%84%E6%9C%80%E5%B0%8F%E5%80%BC%E4%B9%8B%E5%92%8C-%E6%9C%88%E7%9A%84%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98)|
|[LC739. æ¯æ—¥æ¸©åº¦](https://github.com/MyLeetCodeRecord/cpp-leetcode/blob/master/markdown/%E4%B8%93%E9%A2%98%20-%20%E5%8D%95%E8%B0%83%E6%A0%88.md#lc739-%E6%AF%8F%E6%97%A5%E6%B8%A9%E5%BA%A6)|[LC84. æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢](https://github.com/MyLeetCodeRecord/cpp-leetcode/blob/master/markdown/%E4%B8%93%E9%A2%98%20-%20%E5%8D%95%E8%B0%83%E6%A0%88.md#lc84-%E6%9F%B1%E7%8A%B6%E5%9B%BE%E4%B8%AD%E6%9C%80%E5%A4%A7%E7%9A%84%E7%9F%A9%E5%BD%A2)|
|[LC496. ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ I](https://github.com/MyLeetCodeRecord/cpp-leetcode/blob/master/markdown/%E4%B8%93%E9%A2%98%20-%20%E5%8D%95%E8%B0%83%E6%A0%88.md#lc496-%E4%B8%8B%E4%B8%80%E4%B8%AA%E6%9B%B4%E5%A4%A7%E5%85%83%E7%B4%A0i)|[LC42. æ¥é›¨æ°´](https://github.com/MyLeetCodeRecord/cpp-leetcode/blob/master/markdown/%E4%B8%93%E9%A2%98%20-%20%E5%8D%95%E8%B0%83%E6%A0%88.md#lc42-%E6%8E%A5%E9%9B%A8%E6%B0%B4)|
|[LC503. ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ II](https://github.com/MyLeetCodeRecord/cpp-leetcode/blob/master/markdown/%E4%B8%93%E9%A2%98%20-%20%E5%8D%95%E8%B0%83%E6%A0%88.md#lc503-%E4%B8%8B%E4%B8%80%E4%B8%AA%E6%9B%B4%E5%A4%A7%E5%85%83%E7%B4%A0ii)|   |
|[LC901. è‚¡ç¥¨ä»·æ ¼è·¨åº¦](https://github.com/MyLeetCodeRecord/cpp-leetcode/blob/master/markdown/%E4%B8%93%E9%A2%98%20-%20%E5%8D%95%E8%B0%83%E6%A0%88.md#lc901-%E8%82%A1%E7%A5%A8%E4%BB%B7%E6%A0%BC%E8%B7%A8%E5%BA%A6-%E6%9C%88%E7%9A%84%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98)|   |

#### ç±»å‹ä¸€: ä¸¤ä¾§æœ€è¿‘æ›´å¤§/æ›´å°å€¼
> **å•è°ƒæ ˆ**å¯ä»¥ç”¨æ¥æ‰¾`å·¦è¾¹/å³è¾¹`æœ€è¿‘çš„`æ›´å¤§å€¼/æ›´å°å€¼`, æ„é€ å•è°ƒæ ˆçš„æ–¹æ³•æ˜¯è®©æ ˆä¸­***worse***çš„ç»“æœå¼¹å‡ºå»(ä¸å†å¯èƒ½ä½œä¸ºæœ€ä¼˜ç­”æ¡ˆ), æ ¹æ®é¢˜ç›®éœ€è¦, å°†`cur/curä¸‹æ ‡`å‹æ ˆ
> 
> æ›´æ–°`ans`çš„ä¸¤ç§ç›¸å¯¹å…³ç³»: 
> 
> - æ±‚å·¦è¾¹çš„æœ€è¿‘æœ€å¤§/æœ€å° => `ans[cur] = sk.top()`
> 
> - æ±‚å³è¾¹çš„æœ€è¿‘æœ€å¤§/æœ€å° => `ans[popped] = cur`


##### [Acwing830. å•è°ƒæ ˆ](/acwing/Section%202/3_%E5%8D%95%E8%B0%83%E6%A0%88.cpp) 

> æ‰¾åˆ°**å·¦è¾¹**æœ€è¿‘çš„`æ›´å°å€¼`
> 
> å•è°ƒæ ˆæ„é€ : 
> 
> - å¤„ç†`cur=a[i]`æ—¶, æŒç»­åˆ é™¤ä½äº`cur`å·¦è¾¹å¤§äºç­‰äº`cur`çš„æ ˆé¡¶å…ƒç´ , è¿™äº›å…ƒç´ æ°¸è¿œä¸ä¼š(æ¯”`cur`æ›´é€‚åˆ)è¢«ä½œä¸ºç­”æ¡ˆ;
> - å¼¹æ ˆåœæ­¢æ—¶, æ ˆé¡¶å…ƒç´ å°±æ˜¯`cur`å¯¹åº”çš„ç­”æ¡ˆ
> - `cur`å…¥æ ˆ
> 
> "æ‰¾å·¦è¾¹"çš„æ›´æ–°æ–¹å¼: `ans[cur] = sk.top()`

```CPP
for(int i=0; i<n; i++){
    scanf("%d", &cur);
    // æŒç»­åˆ é™¤ä½äºcurå·¦è¾¹å¤§äºç­‰äºcurçš„æ ˆé¡¶å…ƒç´ , è¿™äº›å…ƒç´ æ°¸è¿œä¸ä¼š(æ¯”curæ›´é€‚åˆ)è¢«ä½œä¸ºç­”æ¡ˆ
    // å¾ªç¯ç»ˆæ­¢åçš„æ ˆé¡¶å…ƒç´ å³ä¸ºcurå·¦è¾¹ç¬¬ä¸€ä¸ªå°äºcurçš„å…ƒç´ , è¾“å‡ºå³å¯; è‹¥æ ˆä¸ºç©ºåˆ™è¾“å‡º-1
    while(!sk.empty() && cur<=sk.top())
        sk.pop();
    if(sk.empty())
        printf("-1 ");
    else
        printf("%d ", sk.top());
    sk.push(cur);
}
```


##### [LC739. æ¯æ—¥æ¸©åº¦ğŸ§¡](/workspace/739.%E6%AF%8F%E6%97%A5%E6%B8%A9%E5%BA%A6.cpp)

> æ‰¾åˆ°**å³è¾¹**ç¬¬ä¸€ä¸ª`æ›´å¤§å€¼`(çš„ç›¸å¯¹ä½ç½®), è¦æ±‚è¾“å‡ºé—´è·(å› æ­¤å•è°ƒæ ˆä¸­è¦å­˜**ä¸‹æ ‡**)
> 
> æ€è·¯: å¤„ç†`cur=a[i]`æ—¶, è¦æ±‚è§£çš„æ˜¯æ ˆå†…å¯ä»¥å¼¹å‡ºçš„å…ƒç´ , å¦‚æœ`cur>sk.top()`, åˆ™`cur`å¯ä»¥ä½œä¸º`sk.top()`çš„ç­”æ¡ˆ, å’Œ[Acwing830](https://github.com/MyLeetCodeRecord/cpp-leetcode/blob/master/markdown/%E4%B8%93%E9%A2%98%20-%20%E5%8D%95%E8%B0%83%E6%A0%88.md#acwing830-%E5%8D%95%E8%B0%83%E6%A0%88)æ˜¯ç›¸åçš„å¯¹åº”å…³ç³»
> 
> "æ‰¾å³è¾¹"çš„æ›´æ–°æ–¹å¼: `ans[popped] = cur`

```CPP
vector<int> dailyTemperatures(vector<int>& temperatures) {
    stack<int> sk;
    vector<int> ans(temperatures.size(), 0);
    for(int i=0; i<temperatures.size(); i++){
        int cur = temperatures[i];
        while(!sk.empty() && temperatures[sk.top()]<cur){
            ans[sk.top()] = i-sk.top();
            sk.pop();
        }
        sk.push(i);
    }
    return ans;
}
```
https://leetcode.cn/problems/daily-temperatures/


##### [LC496. ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ IğŸ’š](/workspace/496.%E4%B8%8B%E4%B8%80%E4%B8%AA%E6%9B%B4%E5%A4%A7%E5%85%83%E7%B4%A0-i.cpp)

> ä¸[LC739. æ¯æ—¥æ¸©åº¦](/workspace/739.%E6%AF%8F%E6%97%A5%E6%B8%A9%E5%BA%A6.cpp)çš„ä¸åŒç‚¹åœ¨äº, åœ¨å•ä¸ªæ•°ç»„ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ çš„åŸºç¡€ä¸Š, åŠ ä¸Šäº†**kæ¬¡æŸ¥è¯¢**
> 
> é¢˜ç›®è¯´"nums1æ˜¯nums2çš„å­é›†", å› æ­¤`nums1`å¯ä»¥è§†ä½œå¯¹`nums2`çš„ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ ç»“æœçš„kæ¬¡æŸ¥è¯¢, ä½¿ç”¨`map`å»ºç«‹èµ·`nums2[i]->i`çš„æ˜ å°„å³å¯

```CPP
vector<int> nextGreaterElement(vector<int>& nums1, vector<int>& nums2) {
    vector<int> bigger(nums2.size(), -1);   // å­˜å…ƒç´ å€¼å³å¯
    stack<int> sk;
    for(int i=0; i<nums2.size(); i++){
        while(!sk.empty() && nums2[i]>nums2[sk.top()]){
            bigger[sk.top()] = nums2[i];
            sk.pop();
        }
        sk.push(i);
    }
    unordered_map<int, int> mp;
    for(int i=0; i<nums2.size(); i++){
        mp[nums2[i]] = i;
    }
    vector<int> ans(nums1.size(), -1);
    for(int i=0; i<nums1.size(); i++){
        ans[i] = bigger[mp[nums1[i]]];
    }
    return ans;
}
```
https://leetcode.cn/problems/next-greater-element-i/


##### [LC503. ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ II](/workspace/503.%E4%B8%8B%E4%B8%80%E4%B8%AA%E6%9B%B4%E5%A4%A7%E5%85%83%E7%B4%A0-ii.cpp)
> åœ¨[LC739. æ¯æ—¥æ¸©åº¦](/workspace/739.%E6%AF%8F%E6%97%A5%E6%B8%A9%E5%BA%A6.cpp)è¿›è¡Œ`2*nums.size()`çš„å¾ªç¯å³å¯

```CPP
vector<int> nextGreaterElements(vector<int>& nums) {
    int n = nums.size();
    stack<int> sk;
    vector<int> ans(n, -1);
    for(int i=0; i < 2 * n; i++){
        int cur = nums[i%n];
        while(!sk.empty() && nums[sk.top()] < cur){
            ans[sk.top()] = cur;
            sk.pop();
        }
        sk.push(i%n);
    }
    return ans;
}
```
https://leetcode.cn/problems/next-greater-element-ii/


##### [LC901. è‚¡ç¥¨ä»·æ ¼è·¨åº¦](/workspace/901.%E8%82%A1%E7%A5%A8%E4%BB%B7%E6%A0%BC%E8%B7%A8%E5%BA%A6.cpp): ğŸ”Ÿæœˆçš„æ¯æ—¥ä¸€é¢˜

> ç­‰åŒäº[Acwing830. å•è°ƒæ ˆ](/acwing/Section%202/3_%E5%8D%95%E8%B0%83%E6%A0%88.cpp), æ‰¾å·¦ä¾§æœ€è¿‘æ›´å°å…ƒç´ 

```CPP
class StockSpanner {
public:
    vector<int> stock;
    stack<int> sk;
    int idx = 0;

    StockSpanner() {
    }
    
    int next(int price) {
        stock.push_back(price);
        while(!sk.empty() && price >= stock[sk.top()]){
            sk.pop();
        }
        int ans = idx- (sk.empty() ? -1 : sk.top());
        sk.push(idx++);
        return ans;
    }
};
```
https://leetcode.cn/problems/online-stock-span/


<br/>

---

<br/>

#### ç±»å‹äºŒ: `top' - top - cur`

> ä¸‹é¢çš„å‡ é“é¢˜, ä½¿ç”¨`å•è°ƒæ ˆ`çš„è¯, éƒ½æ˜¯åœ¨`sk.top(), mid, cur`ä¸‰è€…ä¸Šè¿›è¡Œè®¡ç®—
> 
> ä¹Ÿå¯ä»¥ç”¨`åŠ¨æ€è§„åˆ’`, æ„Ÿè§‰åè€Œæ›´å®¹æ˜“æƒ³ä¸€äº›...


##### [LC907. å­æ•°ç»„çš„æœ€å°å€¼ä¹‹å’Œ](/workspace/907.%E5%AD%90%E6%95%B0%E7%BB%84%E7%9A%84%E6%9C%80%E5%B0%8F%E5%80%BC%E4%B9%8B%E5%92%8C.cpp): ğŸ”Ÿæœˆçš„æ¯æ—¥ä¸€é¢˜

> **æ–¹æ³•ä¸€: å•è°ƒæ ˆ**
> 
> ç»´æŠ¤ä¸€ä¸ªå•è°ƒé€’å¢çš„æ ˆ
> 
> ä»¥`mid=sk.top()`ä¸ºæœ€å°å€¼çš„åŒºé—´, åº”è¯¥æ˜¯`ä¸‹ä¸€ä¸ªsk.top()+1`å’Œ`cur-1`ä¹‹é—´
> 
> è¿™ä¸€æ®µçš„**å­æ•°ç»„æ•°é‡**åº”è¯¥æ˜¯`(i-mid) * (mid-sk.top())`

```CPP
// è¦ç»´æŠ¤åŒºé—´ä¸­çš„min, è¯´æ˜æ¯”curå¤§çš„å…ƒç´ åº”è¯¥å¼¹å‡ºå»
int sumSubarrayMins(vector<int>& arr) {
    long long ans = 0;
    // é¦–å°¾æ’å…¥0, ä¸å½±å“ç»“æœ, æ–¹ä¾¿è®¡ç®—
    arr.insert(arr.begin(), 0);
    arr.push_back(0);
    int n = arr.size();
    stack<int> sk;
    for(int i=0; i<n; i++){
        while(!sk.empty() && arr[i] < arr[sk.top()]){
            // tmp: ä»¥arr[mid]ä¸ºminçš„åŒºé—´èŒƒå›´, æ ˆä¸­ä¸‹ä¸€ä¸ªå…ƒç´  ~ i
            // æ–¹æ¡ˆæ•° = æšä¸¾èµ·ç‚¹ã€ç»ˆç‚¹, å³(i-mid) * (mid-sk.top())
            // ans += tmp * arr[mid]
            int mid = sk.top();
            sk.pop();
            long long tmp = (i-mid) * (mid - sk.top());
            tmp %= 1000000007;
            ans += tmp * arr[mid];
            ans %= 1000000007;                
        }
        sk.push(i);
    }
    return ans;
}
```

> **æ–¹æ³•äºŒ: åŠ¨æ€è§„åˆ’**
> 
> ç¡®å®šæ¯ä¸ªæœ€å°å€¼çš„è¾å°„èŒƒå›´ => æšä¸¾å·¦å³é¡¶ç‚¹(åŒºé—´)å¯èƒ½æ€§ => æœ€å°å€¼*å¯èƒ½åŒºé—´

```CPP
int sumSubarrayMins(vector<int>& arr) {
    vector<int> dpLeft(arr.size());
    vector<int> dpRight(arr.size());
    // å·¦è¾¹ç¬¬ä¸€ä¸ªæ›´å°å€¼ä½ç½®
    dpLeft[0] = -1;
    for(int i=1; i<arr.size(); i++){
        int t = i-1;
        while(t>=0 && arr[t] >= arr[i]){
            t = dpLeft[t];
        }
        dpLeft[i] = t;
    }
    // å³è¾¹ç¬¬ä¸€ä¸ªæ›´å°å€¼ä½ç½®
    dpRight[arr.size()-1] = arr.size();
    for(int i=arr.size()-2; i>=0; i--){
        int t = i+1;
        while(t<=arr.size()-1 && arr[t] > arr[i]){
            t = dpRight[t];
        }
        dpRight[i] = t;
    }
    // å¯¹æ¯ä¸ªæœ€å°å€¼æ±‚åŒºé—´é•¿åº¦å¹¶è®°å…¥ans
    long long ans = 0;
    for(int i=0; i<arr.size(); i++){
        // æšä¸¾èµ·ç‚¹ç»ˆç‚¹
        long long tmp = (i - dpLeft[i])*(dpRight[i] - i);
        ans += (tmp % 1000000007) * arr[i];
        ans %= 1000000007;
    }
    return ans;
}
```
https://leetcode.cn/problems/sum-of-subarray-minimums/


##### [LC84. æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢](/workspace/84.%E6%9F%B1%E7%8A%B6%E5%9B%BE%E4%B8%AD%E6%9C%80%E5%A4%A7%E7%9A%84%E7%9F%A9%E5%BD%A2.cpp)

> ä»¥`height[i]`ä¸º(æœ€å°)é«˜åº¦, åˆ†åˆ«æ‰¾åˆ°å·¦ä¾§ã€å³ä¾§å¤§äº`height[i]`æ‰€èƒ½å»¶ä¼¸çš„æœ€è¿œæ¨ªå‘èŒƒå›´, å³å®šä½åˆ°å·¦ä¾§ã€å³ä¾§ç¬¬ä¸€ä¸ªå°äºä½äº`height[i]`çš„ä½ç½®(**å·¦ä¾§ & å³ä¾§æœ€è¿‘çš„æ›´å°å…ƒç´ **), è®¡ç®—ä¸€ä¸ªå¯èƒ½çš„å€™é€‰ç­”æ¡ˆ
> 
> ä»¥`height[i]`ä¸ºçŸ©å½¢çš„é«˜çš„æœ€å¤§çŸ©å½¢é¢ç§¯å³ä¸º`height[i]*(rLower[i]-lLower[i]-1)`
> 
> æ±‚`lLower[i]`å’Œ`rLower[i]`çš„æ–¹æ³•å¯ä»¥æ˜¯`åŠ¨æ€è§„åˆ’`æˆ–è€…`å•è°ƒæ ˆ`

> **æ–¹æ³•ä¸€: åŠ¨æ€è§„åˆ’ - è®°å½•`lLower[i]`, `rLower[i]`**

```CPP
// dpLeft[i]: å·¦è¾¹ç¬¬ä¸€ä¸ªæ¯”height[i]ä½çš„
// dpRight[i]: å³è¾¹ç¬¬ä¸€ä¸ªæ¯”height[i]ä½çš„
int largestRectangleArea(vector<int>& heights) {
    int n = heights.size();
    vector<int> left(n, -1);
    vector<int> right(n, n);
    // æ‰¾å·¦è¾¹æœ€è¿‘æ›´ä½ï¼ˆç¬¬ä¸€ä¸ªæ›´ä½çš„ï¼‰
    for (int i = 1; i < n; i++) {
        int t = i - 1;
        while(t >= 0 && heights[t] >= heights[i])
            t = left[t];
        left[i] = t;
    }
    // æ‰¾å³è¾¹æœ€è¿‘æ›´ä½ï¼ˆç¬¬ä¸€ä¸ªæ›´ä½çš„ï¼‰
    for (int i = n - 2; i >= 0; i--) {
        int t = i + 1;
        while(t < n && heights[t] >= heights[i])
            t = right[t];
        right[i] = t;
    }
    // éå†æ¯ä¸ªä½ç½®left~right
    int ans = 0;
    for (int i = 0; i < n; i++) {
        int h = heights[i];  // iæœ¬èº«æ˜¯çŸ­æ¿ => é«˜åº¦
        int w = right[i]-left[i]-1;  // leftå’Œrightæ•°ç»„è®°å½•ä¸‹æ ‡è€Œä¸æ˜¯é«˜åº¦æœ¬èº« => å®½åº¦
        ans = max(ans, h*w);
    }
    return ans;
}
```

> **æ–¹æ³•äºŒ: å•è°ƒæ ˆ**
> 
> è¯¦è§[è¿™é‡Œ](https://programmercarl.com/0084.%E6%9F%B1%E7%8A%B6%E5%9B%BE%E4%B8%AD%E6%9C%80%E5%A4%A7%E7%9A%84%E7%9F%A9%E5%BD%A2.html), éš¾æ‡‚...
> 
> é‡åˆ°æ›´å°çš„è¦å…¥æ ˆ, å°±è®¡ç®—ä»¥æ ˆé¡¶å…ƒç´ ä¸º`height`çš„çŸ©å½¢é¢ç§¯, å®ƒçš„å®½åº¦èŒƒå›´åº”è¯¥æ˜¯`æ ˆé¡¶çš„ç¬¬äºŒä¸ªå…ƒç´ `~`cur`

```CPP
// å•è°ƒæ ˆ, æ‰¾å·¦ã€å³æ¯”midæ›´é«˜çš„åŒºé—´
// ä»¥heights[mid]ä¸ºçŸ©å½¢é«˜, å³ä½ç‚¹
int largestRectangleArea(vector<int>& heights) {
    // æ•°ç»„å¤´å°¾åŠ ä¸Š0, æ–¹ä¾¿ç»Ÿä¸€å¤„ç†
    heights.insert(heights.begin(), 0);
    heights.push_back(0);
    int ans = 0;

    stack<int> sk;  // å•è°ƒé€’å¢çš„æ ˆ
    sk.push(0);
    for(int i=1; i<heights.size(); i++){
        // æ›´æ–°ä¸‹æ ‡
        if(heights[i] == heights[sk.top()]){
            sk.pop();
            sk.push(i);
        }
        // curæ›´é«˜ => push
        else if(heights[i] > heights[sk.top()]){
            sk.push(i);
        }
        // curæ›´ä½ => 
        else{
            while(!sk.empty() && heights[i]<heights[sk.top()]){
                int mid = sk.top();
                sk.pop();
                if(!sk.empty()){
                    int h = heights[mid];
                    int w = i-sk.top()-1;
                    ans = max(ans, h*w);
                }
            }
            sk.push(i);
        }
    }
    return ans;
}
```
https://leetcode.cn/problems/largest-rectangle-in-histogram/


##### [LC42. æ¥é›¨æ°´](/workspace/42.%E6%8E%A5%E9%9B%A8%E6%B0%B4.cpp)
> **æ–¹æ³•ä¸€: åŠ¨æ€è§„åˆ’ - æŒ‰åˆ—æ±‚**
> 
> æ±‚`å·¦è¾¹çš„æœ€é«˜` & `å³è¾¹çš„æœ€é«˜`, ç„¶åå°† `min(lhighest[i], rhighest[i]) - curHeight` ä½œä¸ºå½“å‰åˆ—çš„å®¹é‡
> 
> ![LC42. æŒ‰åˆ—æ±‚](https://img-blog.csdnimg.cn/20210402091208445.png)

```CPP
int trap(vector<int>& height) {
    vector<int> lHighest(height.size(), height[0]);
    vector<int> rHighest(height.size(), height.back());
    for(int i=1; i<height.size(); i++){
        lHighest[i] = max(height[i-1], lHighest[i-1]);  // åˆ«ç”¨å½“å‰åˆ—å“¦
    }
    for(int i=height.size()-2; i>=0; i--){
        rHighest[i] = max(height[i+1], rHighest[i+1]);
    }
    int ans = 0;
    for(int i=1; i<height.size()-1; i++){
        if(lHighest[i] > height[i] && rHighest[i] > height[i]){
            ans += min(lHighest[i], rHighest[i]) - height[i];
        }
    }
    return ans;
}
```

> **æ–¹æ³•äºŒ: å•è°ƒæ ˆ - æŒ‰å±‚æ±‚**
> 
> ç»´æŠ¤**å•è°ƒé€’å‡çš„æ ˆ**
> 
> - ç›¸åŒ => æ›´æ–°`top`
> - `cur`æ¯”`top`é«˜ => å¼¹å‡ºä¸€ä¸ªå…ƒç´ `mid`ä½œä¸ºå±‚çš„åº•éƒ¨, `min(h[sk.top()], h[i])`ä½œä¸ºå±‚çš„é¡¶éƒ¨, `h = min(h[sk.top()], h[i]) - h[mid]`, æ±‚ä¸€ä¸ª`delta(minTop-h[mid])`çš„å±‚å®¹é‡, ä¸è¦è€ƒè™‘ä¸­é—´çš„"å‡¹å‘, å·²ç»åœ¨å‰é¢çš„å±‚ä¸­ç»Ÿè®¡è¿‡äº†
> - `cur`æ¯”`top`ä½ => `sk.push(cur)`
> 
> ![LC42-æŒ‰å±‚æ±‚](https://img-blog.csdnimg.cn/20210402091118927.png)

```CPP
int trap(vector<int>& height) {
    stack<int> sk;  // å•è°ƒé€’å‡çš„æ ˆ
    int ans = 0;
    for(int i=0; i<height.size(); i++){
        // ç›¸åŒ => æ›´æ–°topä¸‹æ ‡
        if(!sk.empty() && height[i] == height[sk.top()]){
            sk.pop();
            sk.push(i);
            continue;   // åˆ«pushä¸¤æ¬¡
        }
        // æ ˆé¡¶å…ƒç´ æ›´ä½
        while(!sk.empty() && height[i] > height[sk.top()]){
            int mid = sk.top(); // åº•éƒ¨
            sk.pop();
            if(!sk.empty()){
                int h = min(height[sk.top()], height[i]) - height[mid]; // leftå’Œcurä¸­æ›´å°çš„ä¸€ä¸ª - åº•éƒ¨é«˜åº¦
                int w = i-sk.top()-1;   // cur-left
                ans += w*h;
            }
        }
        sk.push(i);
    }
    return ans;
}
```
https://leetcode.cn/problems/trapping-rain-water/