#### å·®åˆ†

> é—®é¢˜: å¤šæ¬¡æ“ä½œ, æ¯ä¸ªæ“ä½œå¯¹`l ~ r`èŒƒå›´è¿›è¡Œä¸€æ¬¡åŒºé—´`+c`æ“ä½œ
> 
> è½¬åŒ–ä¸ºå·®åˆ†é—®é¢˜ => `diff[l] += a` & `diff[r+1] -= a`(å¦‚æœr+1ä¸è¶Šç•Œ)
>
> å¦‚æœåŸå§‹æ•°ç»„æœ‰åˆå§‹å€¼ => `diff[i] += x` & `diff[i+1] -= x`(è§†ä½œä¸€æ¬¡é•¿åº¦ä¸º1çš„å·®åˆ†)
> 
> æœ€åå†å¯¹`diffæ•°ç»„`æ±‚[å‰ç¼€å’Œ](/markdown/%E4%B8%93%E9%A2%98%20-%20%E5%89%8D%E7%BC%80%E5%92%8C.md)æ¢å¤åˆ°åŸå§‹æ•°ç»„


##### [LC1109. èˆªç­é¢„å®šç»Ÿè®¡](/workspace/1109.%E8%88%AA%E7%8F%AD%E9%A2%84%E8%AE%A2%E7%BB%9F%E8%AE%A1.cpp)

> ç›´è§‚çš„å·®åˆ†é—®é¢˜, æ³¨æ„ä¸‹æ ‡ä»`0`å¼€å§‹

```CPP
// å¯¹æŸä¸ªèŒƒå›´[param1, param2]è¿›è¡Œä¸€æ¬¡åŒºé—´åŠ æ“ä½œ => å·®åˆ†
vector<int> diff;
void diff_operation(int l, int r, int c){
    diff[l] += c;
    diff[r+1] -= c;
}
vector<int> corpFlightBookings(vector<vector<int>>& bookings, int n) {
    diff.resize(n+1);
    for(vector<int> op: bookings){
        int l = op[0]-1;
        int r = op[1]-1;
        int c = op[2];
        diff_operation(l, r, c);
    }
    vector<int> prefixSum(n, 0);
    prefixSum[0] = diff[0];
    for(int i=1; i<n; i++){
        prefixSum[i] = prefixSum[i-1] + diff[i];
    }
    return prefixSum;
}
```
https://leetcode.cn/problems/corporate-flight-bookings


##### [LC1094. æ‹¼è½¦](/workspace/1094.%E6%8B%BC%E8%BD%A6.cpp)

> æ³¨æ„indexå¼€å§‹ä½ç½®ä¸º 0, ä¸[LC1109. èˆªç­é¢„å®šç»Ÿè®¡](/markdown/%E4%B8%93%E9%A2%98%20-%20%E5%B7%AE%E5%88%86.md#lc1109-%E8%88%AA%E7%8F%AD%E9%A2%84%E5%AE%9A%E7%BB%9F%E8%AE%A1)ä¸åŒ
> 
> å¯¹äº`prefixSum[0]`ä¹Ÿè¦åˆ¤æ–­`capacity`

```CPP
class Solution {
public:
    bool carPooling(vector<vector<int>>& trips, int capacity) {
        // è®¡ç®—å·®åˆ†(Index ä» 0 å¼€å§‹)
        int maxLen = 0;
        vector<int> diff(1001, 0);
        for(vector<int> t: trips){
            diff[t[1]] += t[0];
            diff[t[2]] -= t[0];
            maxLen = max(maxLen, max(t[1], t[2]));
        }
        // è¿™é‡Œçš„å‰ç¼€å’Œçœç•¥ä¸ºä¸¤ä¸ªcumSumå³å¯
        // int cumSum = diff[0];
        vector<int> prefixSum(maxLen+1, 0);
        prefixSum[0] = diff[0];
        if(prefixSum[0] > capacity)
            return false;
        for(int i=1; i<=maxLen; i++){
            prefixSum[i] = prefixSum[i-1]+diff[i];
            if(prefixSum[i] > capacity)
                return false;
        }
        return true;
    }
};
```
https://leetcode.cn/problems/car-pooling/



##### [253. ä¼šè®®å®¤II](/workspace/253.ä¼šè®®å®¤II.cpp): `map`å­˜å‚¨çš„`å·®åˆ†`

> è¿™é“é¢˜å¦‚æœç›´æ¥ç”¨`diff`æ•°ç»„, èŒƒå›´å·²ç»åˆ°äº†`0 <= starti < endi <= 10^6`
>
> æ‰€ä»¥è€ƒè™‘ç”¨æ™®é€šå“ˆå¸Œè¡¨å­˜å‚¨, ä½†æœ€åä¹Ÿè¦æŒ‰ä»ä½åˆ°é«˜çš„é¡ºåºæ±‚å’Œ â¡ï¸ æ‰€ä»¥è¦ç”¨keyæœ‰åºçš„æ•°æ®ç»“æ„ â¡ï¸ `map`
>
> ğŸ’¡å—åˆ°è¿™ä¸ªå¸–å­çš„å¯å‘, é‡Œé¢çš„`vector<PII>`â•`sort`å…¶å®å°±ç­‰äºmap

```CPP
// [start, end]èŒƒå›´æ›´å¤§çš„ã€Œ1094. æ‹¼è½¦ã€
int minMeetingRooms(vector<vector<int>>& intervals) {
    map<int, int> diff;
    for(vector<int> &interval : intervals){
        int l = interval[0], r = interval[1];
        diff[l] += 1;
        diff[r] -= 1;
    }
    int ans = 0;
    int preSum = 0;
    for(auto &[k, v]: diff){
        preSum += v;
        ans = max(ans, preSum);
    }
    return ans;
}
```



#### äºŒç»´å·®åˆ†

> ![äºŒç»´å·®åˆ†](/appendix/%E4%BA%8C%E7%BB%B4%E5%B7%AE%E5%88%86.png)
> 
> - `d[x1][y1] += c`
> - `d[x2+1][y1] -= c`
> - `d[x1][y2+1] -= c`
> - `d[x2+1][y2+1] += c`
> 
> æœ€åå†å¯¹`diff`æ±‚[äºŒç»´å‰ç¼€å’Œ](/markdown/%E4%B8%93%E9%A2%98%20-%20%E5%89%8D%E7%BC%80%E5%92%8C.md#%E4%BA%8C%E7%BB%B4%E5%89%8D%E7%BC%80%E5%92%8C)æ˜ å°„å›åŸç©ºé—´

```CPP
vector<vector<int> > diff(m+1, vector<int>(n+1, 0));

vector<vector<int> > operation(int v, int x1, int y1, int x2, int y2){
    // å¯¹ x1, y1, x2, y2è¿›è¡Œè¾¹ç•Œåˆ¤æ–­
    diff[x1][y1] += v;
    diff[x2+1][y1] -= v;
    diff[x1][y2+1] -= v;
    diff[x2+1][y2+1] += v;

    // å¯¹diffæ±‚å‰ç¼€å’Œ, æ˜ å°„å›åŸçŸ©é˜µ
    return preSum(diff);
}
```


##### [2536. å­çŸ©é˜µå…ƒç´ åŠ  1](/record/2023/Weekly%20328.md)

> æ³¨æ„`diff[][]`æ²¡æœ‰åç§», `prefixSum[][]`æœ‰åç§»

```CPP
void diff_operation(vector<vector<int>>& diff, int x1, int y1, int x2, int y2, int c){
    diff[x1][y1] += c;
    diff[x1][y2+1] -= c;
    diff[x2+1][y1] -= c;
    diff[x2+1][y2+1] += c;
}
vector<vector<int>> rangeAddQueries(int n, vector<vector<int>>& queries) {
    vector<vector<int>> diff(n+1, vector<int>(n+1, 0));
    for(vector<int> &q: queries){
        diff_operation(diff, q[0], q[1], q[2], q[3], 1);
    }
    // å¯¹diff[][]æ±‚å‰ç¼€å’Œå¾—åˆ°a[][]
    vector<vector<int>> a(n+1, vector<int>(n+1, 0));
    for(int i=1; i<=n; i++){
        for(int j=1; j<=n; j++){
            a[i][j] = diff[i-1][j-1] + a[i-1][j] + a[i][j-1] - a[i-1][j-1];
        }
    }
    // æ¶ˆé™¤å‰ç¼€å’ŒçŸ©é˜µçš„é”™ä½
    vector<vector<int>> ans(n, vector<int>(n, 0));
    for(int i=0; i<n; i++){
        for(int j=0; j<n; j++){
            ans[i][j] = a[i+1][j+1];
        }
    }
    return ans;
}
```
https://leetcode.cn/problems/increment-submatrices-by-one/

<br/>

##### [2132. ç”¨é‚®ç¥¨è´´æ»¡ç½‘æ ¼å›¾](https://leetcode.cn/problems/stamping-the-grid/)

> todo